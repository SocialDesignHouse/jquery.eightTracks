/*! jquery.eightTracks v0.0.1 - Social Design House */
(function(d,f,l,e){var m={};var p=d("body");var w={regular:"http://8tracks.com/",secure:"https://8tracks.com/"};var v="";var z="";var n={};var k={};var h={};var i={perPage:10,sort:"hot"};var g={invalid_id:"The ID supplied was not valid",invalid_ids:"One or more of the IDs supplied were not valid.",not_logged:"Could not log track play. Please try again.",no_token:"Could not retrieve play token.",skip_failed:"Could not skip track.",next_failed:"Could not retrieve next track.",next_mix_failed:"Could not retrieve next mix.",find_mix_failed:"Could not retrieve specified mix.",mix_failed:"Could not start mix.",search_failed:"Could not get search results."};m.store={};m.init=function r(B,C){var A=this;if(typeof C==="object"){A.options=d.extend({},i,C);}if(typeof B==="string"&&B){v=B;c();}else{return false;}};m.startMix=function o(D){var A=this;var C={mix_id:D,api_key:v};var B=d.ajax({type:"GET",url:t("sets/"+z+"/play.jsonp"),dataType:"jsonp",data:C});B.done(function(E){if(E.status=="200 OK"){k=E;m.store.mix=k;n=E.set.track;m.store.track=n;p.trigger("mixStarted",[k,n]);}else{p.trigger("mix_failed","mixStarted");}});};m.skipTrack=function b(B,E,A){B=j(B);if(B){var D={api_key:v,mix_id:B};var C=d.ajax({type:"GET",url:t("sets/"+z+"/skip.jsonp"),dataType:"jsonp",data:D});C.done(function(F){if(F.status=="200 OK"){n=F;m.store.track=F;p.trigger("newTrack",n);}else{if(typeof E!=="undefined"&&E){if(j(A)){m.startMix(A);}else{m.nextMix(B);}}}});}else{a("invalid_id","newTrack");}};m.nextTrack=function q(A){A=j(A);if(j(A)){var C={api_key:v,mix_id:A};var B=d.ajax({type:"GET",url:t("sets/"+z+"/next.jsonp"),dataType:"jsonp",data:C});B.done(function(D){if(D.status=="200 OK"){n=D;m.track=D;p.trigger("newTrack",n);}else{a("next_failed","newTrack");}});}else{a("invalid_id","newTrack");}};m.nextMix=function u(A){A=j(A);if(A){var C={api_key:v,mix_id:A};var B=d.ajax({type:"GET",url:t("sets/"+z+"/next_mix.jsonp"),dataType:"jsonp",data:C});B.done(function(D){if(D.status=="200 OK"){p.trigger("newMix",D);}else{a("next_mix_failed","newMix");}});}else{a("invalid_id","newMix");}};m.tagSearch=function y(B){var A=this;var F={api_key:v,sort:A.options.sort,per_page:A.options.perPage};if(typeof B==="object"){var C="";for(var D in B){if(B.hasOwnProperty(D)){C+=x(B[D])+"%2B";}}C=C.substr(0,C.length-3);F.tags=C;}else{F.tag=x(B);}var E=d.ajax({type:"GET",url:t("mixes.jsonp"),dataType:"jsonp",data:F});E.done(function(G){if(G.status=="200 OK"){h=G;p.trigger("searchResultsFound",G);}else{a("search_failed","searchResultsFound");}});};m.logPlay=function s(B,A){B=j(B);A=j(A);if(B&&A){var D={mix_id:B,track_id:A,api_key:v};var C=d.ajax({type:"GET",url:t("sets/"+z+"/report.jsonp"),dataType:"jsonp",data:D});C.done(function(E){if(E.status=="200 OK"){p.trigger("trackLogged",E);}else{a("not_logged","trackLogged");}});}else{a("invalid_ids","trackLogged");}};function c(){var B={api_key:v};var A=d.ajax({type:"GET",url:t("sets/new.jsonp"),dataType:"jsonp",data:B});A.done(function(C){if(C.status=="200 OK"){z=C.play_token;m.store.playToken=z;p.trigger("playTokenFound",C);}else{a("no_token","playTokenFound");}});}function t(A,C){var B=w.regular;if(typeof C!=="undefined"&&C){B=w.secure;}if(typeof A==="string"){B+=A;}return B;}function j(A){if(typeof A!=="undefined"){if(typeof A==="string"||typeof A==="number"){return A;}else{if(typeof A==="object"&&A.id.length){if(typeof A.id==="string"||typeof A.id==="number"){return A.id;}else{return false;}}else{return false;}}}else{return false;}}function x(A){A=d.trim(A);A=A.replace(" ","+");return A;}function a(A,C){var D=g[A];p.trigger("eightTracksError",[A,D]);if(typeof C==="string"){var B={error:1,code:A,msg:D};p.trigger(C,B);}}if(!d.eightTracks){d.extend({eightTracks:m});}})(jQuery,window,document);