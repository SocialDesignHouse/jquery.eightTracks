/*! jquery.eightTracks v0.0.2 - Social Design House */
(function(e,g,m,f){var n={};var p=e("body");var w={regular:"http://8tracks.com/",secure:"https://8tracks.com/"};var v="";var z="";var o={};var l={};var i={};var j={perPage:10,sort:"hot"};var h={invalid_id:"The ID supplied was not valid",invalid_ids:"One or more of the IDs supplied were not valid.",not_logged:"Could not log track play. Please try again.",no_token:"Could not retrieve play token.",skip_failed:"Could not skip track.",next_failed:"Could not retrieve next track.",next_mix_failed:"Could not retrieve next mix.",find_mix_failed:"Could not retrieve specified mix.",mix_failed:"Could not start mix.",search_failed:"Could not get search results."};n.store={};n.init=function r(B,C){var A=this;if(typeof C==="object"){A.options=e.extend({},j,C);}if(typeof B==="string"&&B){v=B;d();}else{return false;}};n.startMix=function c(D){var A=this;var C={mix_id:D,api_key:v};var B=e.ajax({type:"GET",url:t("sets/"+z+"/play.jsonp"),dataType:"jsonp",data:C});B.done(function(E){if(E.status=="200 OK"){l=E;n.store.mix=l;o=E.set.track;n.store.track=o;p.trigger("mixStarted",[l,o]);}else{p.trigger("mix_failed","mixStarted");}});};n.skipTrack=function b(B,E,A){B=k(B);if(B){var D={api_key:v,mix_id:B};var C=e.ajax({type:"GET",url:t("sets/"+z+"/skip.jsonp"),dataType:"jsonp",data:D});C.done(function(F){if(F.status=="200 OK"){o=F;n.store.track=F;p.trigger("newTrack",o);}else{if(typeof E!=="undefined"&&E){if(k(A)){n.startMix(A);}else{n.nextMix(B);}}}});}else{a("invalid_id","newTrack");}};n.nextTrack=function q(A){A=k(A);if(k(A)){var C={api_key:v,mix_id:A};var B=e.ajax({type:"GET",url:t("sets/"+z+"/next.jsonp"),dataType:"jsonp",data:C});B.done(function(D){if(D.status=="200 OK"){o=D;n.track=D;p.trigger("newTrack",o);}else{a("next_failed","newTrack");}});}else{a("invalid_id","newTrack");}};n.nextMix=function u(B,A){B=k(B);if(B){var D={api_key:v,mix_id:B};if(typeof A!=="undefined"){A=k(A);if(A){D.mix_set_id=A;}}var C=e.ajax({type:"GET",url:t("sets/"+z+"/next_mix.jsonp"),dataType:"jsonp",data:D});C.done(function(E){if(E.status=="200 OK"){p.trigger("newMix",E);}else{a("next_mix_failed","newMix");}});}else{a("invalid_id","newMix");}};n.tagSearch=function y(I){var E=this;var B={api_key:v,sort:E.options.sort,per_page:E.options.perPage};if(typeof I==="object"){var D=[];var A=0;var H=0;var G=2;for(var C in I){if(I.hasOwnProperty(C)){if(A<(H+1)*G){if(typeof D[H]!=="undefined"&&D[H].length){D[H]+=x(I[C])+"%2B";}else{D[H]=x(I[C])+"%2B";}}else{H++;D[H]=x(I[C])+"%2B";}A++;}}for(var C in D){if(D.hasOwnProperty(C)){D[C]=D[C].substr(0,D[C].length-3);}}B.tags=D[0];}else{B.tag=x(I);}var F=e.ajax({type:"GET",url:t("mixes.jsonp"),dataType:"jsonp",data:B});F.done(function(J){if(J.status=="200 OK"){i=J;n.store.results=i;p.trigger("searchResultsFound",i);}else{a("search_failed","searchResultsFound");}});};n.logPlay=function s(B,A){B=k(B);A=k(A);if(B&&A){var D={mix_id:B,track_id:A,api_key:v};var C=e.ajax({type:"GET",url:t("sets/"+z+"/report.jsonp"),dataType:"jsonp",data:D});C.done(function(E){if(E.status=="200 OK"){p.trigger("trackLogged",E);}else{a("not_logged","trackLogged");}});}else{a("invalid_ids","trackLogged");}};function d(){var B={api_key:v};var A=e.ajax({type:"GET",url:t("sets/new.jsonp"),dataType:"jsonp",data:B});A.done(function(C){if(C.status=="200 OK"){z=C.play_token;n.store.token=z;p.trigger("playTokenFound",C);}else{a("no_token","playTokenFound");}});}function t(A,C){var B=w.regular;if(typeof C!=="undefined"&&C){B=w.secure;}if(typeof A==="string"){B+=A;}return B;}function k(A){if(typeof A!=="undefined"){if(typeof A==="string"||typeof A==="number"){return A;}else{if(typeof A==="object"&&A.id.length){if(typeof A.id==="string"||typeof A.id==="number"){return A.id;}else{return false;}}else{return false;}}}else{return false;}}function x(A){var B=e.trim(A);B=B.replace(" ","_");return B;}function a(A,C){var D=h[A];p.trigger("eightTracksError",[A,D]);if(typeof C==="string"){var B={error:1,code:A,msg:D};p.trigger(C,B);}}if(!e.eightTracks){e.extend({eightTracks:n});}})(jQuery,window,document);